<ion-header>
  <pp-app-header></pp-app-header>
  <app-task-toolbar [activeFiltersCount]="activeCategoryFilters.length" (searchChange)="onSearchChange($event)"
    (filterClick)="openCategoryModal()" (sortChange)="onSortChange($event)">
  </app-task-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <ion-list *ngIf="tasks.length; else empty" class="task-list">

    <ion-item *ngFor="let task of tasks" lines="none" class="task-item">

      <div class="task-content">
        
        <!-- TEXTO -->
        <ion-label class="task-label">
          <h2>{{ task.title }}</h2>
          <p>{{ task.description }}</p>
          <ion-badge color="medium">
            {{ task.category }}
          </ion-badge>
        </ion-label>

        <!-- ACCIONES -->
        <div class="task-actions">
          
          <!-- Botones principales -->
          <ion-button 
            fill="solid" 
            color="warning" 
            size="small" 
            class="action-button discard-button"
            (click)="discardTask(task.id)">
            <ion-icon slot="start" [icon]="arrowBackCircleIcon"></ion-icon>
            Descartar
          </ion-button>

          <ion-button 
            fill="solid" 
            color="success" 
            size="small" 
            class="action-button complete-button"
            (click)="completeTask(task.id)">
            <ion-icon slot="start" [icon]="checkmarkCircleIcon"></ion-icon>
            Completar
          </ion-button>

          <!-- Botones secundarios -->
          <div class="secondary-actions">
            <ion-button 
              fill="clear" 
              size="small" 
              class="icon-button"
              (click)="openEdit(task)">
              <ion-icon slot="icon-only" [icon]="createIcon"></ion-icon>
            </ion-button>
            <ion-button 
              fill="clear" 
              size="small" 
              color="danger" 
              class="icon-button"
              (click)="deleteTask(task.id)">
              <ion-icon slot="icon-only" [icon]="trashIcon"></ion-icon>
            </ion-button>
          </div>

        </div>

      </div>

    </ion-item>

  </ion-list>

  <!-- ===== EMPTY ===== -->
  <ng-template #empty>
    <div class="empty-state">
       <ion-icon [icon]="clipboardIcon"></ion-icon>
      <p>No tienes tareas asignadas</p>
    </div>
  </ng-template>

</ion-content>